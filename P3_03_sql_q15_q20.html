<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.issued" content="2020-05-02T18:19:18.825533184" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2020-06-19T15:19:31.328881756" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
    @page {  }
    table { border-collapse:collapse; border-spacing:0; empty-cells:show }
    td, th { vertical-align:top; font-size:12pt;}
    h1, h2, h3, h4, h5, h6 { clear:both;}
    ol, ul { margin:0; padding:0;}
    li { list-style: none; margin:0; padding:0;}
    /* "li span.odfLiEnd" - IE 7 issue*/
    li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
    span.footnodeNumber { padding-right:1em; }
    span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
    span.heading_numbering { margin-right: 0.8rem; }* { margin:0;}
    .P1 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P10 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P11 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P12 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P13 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P14 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P15 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P17 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P18 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P19 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P2 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P20 { font-size:10.5pt; font-family:Arial, helvetica, sans-serif; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P21 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P22 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P23 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P24 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P25 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P26 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P27 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P28 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P29 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P3 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P32 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#ce181e; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P39 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; }
    .P4 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P40 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P41 { font-size:12pt; line-height:115%; margin-bottom:0.247cm; margin-top:0cm; font-family:Montserat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P42 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P44 { font-size:12pt; font-family:Montserrat; writing-mode:page; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P5 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P6 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .P7 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P8 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .P9 { font-size:12pt; font-family:Montserrat; writing-mode:page; margin-left:0cm; margin-right:0cm; text-indent:0cm; color:#000000; letter-spacing:normal; font-style:normal; font-weight:normal; }
    .Strong_20_Emphasis { font-size:12pt; font-family:Liberation Serif; writing-mode:lr-tb; text-align:left ! important; font-weight:bold; }
    .Strong_20_Emphasis { font-weight:bold; }
    .T1 { color:#ce181e; font-family:Montserrat; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .T10 { color:#000000; }
    .T11 { color:#000000; font-weight:normal; }
    .T12 { color:#000000; font-weight:normal; }
    .T13 { color:#000000; font-weight:normal; }
    .T14 { color:#000000; font-weight:normal; }
    .T2 { color:#ce181e; font-family:Montserrat; font-size:12pt; letter-spacing:normal; font-style:normal; font-weight:bold; }
    .T21 { color:#000000; font-weight:normal; }
    .T22 { color:#000000; font-weight:normal; }
    .T23 { color:#000000; font-weight:normal; }
    .T25 { color:#000000; font-weight:bold; }
    .T26 { color:#000000; font-weight:bold; }
    .T27 { color:#000000; }
    .T3 { color:#ce181e; }
    .T32 { color:#72bf44; }
    .T4 { color:#ce181e; }
    .T5 { color:#ce181e; }
    .T6 { color:#ce181e; }
    .T7 { color:#ce181e; }
    .T8 { color:#ce181e; }
    /* ODF styles with no properties representable as CSS */
    .T33 .T34 .T35 .T36 .T9  { }
    </style></head><body dir="ltr" style="max-width:21.001cm;margin-top:2cm; margin-bottom:2cm; margin-left:2cm; margin-right:2cm; "><p class="P39"><span class="T1">Question 15  </span><span class="T2">Clef primaire :</span></p><p class="P21"> </p><p class="P2">code_pays + annee</p><p class="P2">code_pays : c’est un entier donc une clef plus légère qu’un nom de pays</p><p class="P2"><span> </span><span> optimisant les requêtes en base de données</span></p><p class="P2">annee : le code_pays ne sera plus un identifiant unique si on charge les données de plusieurs années.</p><p class="P2"> </p><p class="P22">Question 16 Clef primaire :</p><p class="P1"> </p><p class="P5">code_pays+année+code_produit</p><p class="P1"> </p><p class="P5">code_pays : clef articielle , optimise les recherches</p><p class="P5">annee : code_pays n’est plus unique si on charge les données sur plusieurs années.</p><p class="P5">code_produit : clef articielle optimise les recherches par rapport au nom de produit.</p><p class="P5"> </p><p class="P7"><span class="T3">Question 1</span><span class="T4">7</span><span class="T3"> Clef primaire :</span></p><p class="P3"> </p><p class="P6">code_pays+année+code_produit</p><p class="P3"> </p><p class="P6">code_pays : clef articielle , optimise les recherches</p><p class="P6">annee : code_pays n’est plus unique si on charge les données sur plusieurs années.</p><p class="P6">code_produit : clef articielle ,<span class="T9">unique à chaque produit, </span>optimise les recherches par rapport au nom de produit.</p><p class="P6"> </p><p class="P8"><span class="T3">Question 1</span><span class="T5">8</span><span class="T3"> Clef primaire :</span></p><p class="P25"> </p><p class="P4">code_pays + annee</p><p class="P4"> </p><p class="P4">code_pays : c’est un entier donc une clef plus légère qu’un nom de pays</p><p class="P4"><span> </span><span> optimisant les requêtes en base de données</span></p><p class="P4"> </p><p class="P9">annee : le code_pays ne sera plus un identifiant unique si on charge les données de plusieurs années.</p><p class="P9"> </p><p class="P23"> </p><p class="P23"> </p><p class="P23"> </p><p class="P40"><span class="T6">Question </span><span class="T7">19 : les re</span><span class="T8">q</span><span class="T7">uêtes SQL</span></p><p class="P26"> </p><p class="P26"><span class="T10">Les 10 pays ayant le plus haut ratio </span><span class="Strong_20_Emphasis"><span class="T25">disponibilité alimentaire/habitant </span></span><span class="T10">en termes de protéines (en kg) par habitant, </span><span class="Strong_20_Emphasis"><span class="T25">puis</span></span><span class="T10"> en termes de kcal par habitant</span><span class="T32">.</span></p><p class="P10"> </p><p class="P11">SELECT      d.pays,</p><p class="P11">                  sum(d.dispo_prot*365/1000) AS dispo_prot_kg_habitant</p><p class="P11">FROM         fao.dispo_alim d</p><p class="P11">GROUP BY  d.pays</p><p class="P11">ORDER BY  dispo_prot_kg_habitant DESC</p><p class="P11">LIMIT 10 ;</p><p class="P11"> </p><p class="P12">SELECT <span> d.pays, </span></p><p class="P27"><span class="T11">                </span><span class="T21">sum</span><span class="T11">(d.dispo_</span><span class="T12">alim_kcal_p_j</span><span class="T11">*365) AS dispo_</span><span class="T12">kcal</span><span class="T11">_habitant</span></p><p class="P12">FROM<span>  </span><span> <span class="T34">fao.</span>dispo_alim d</span></p><p class="P12">GROUP BY<span> d.pays</span></p><p class="P27"><span class="T11">ORDER BY         dispo_</span><span class="T12">kcal</span><span class="T11">_habitant DESC</span></p><p class="P12">LIMIT 10 ; </p><p class="P12"> </p><p class="P27"><span class="T10">Pour l'année 2013, les 10 pays ayant le plus faible ratio </span><span class="Strong_20_Emphasis"><span class="T25">disponibilité alimentaire/habitant</span></span><span class="T10"> en termes de protéines (en kg) par habitant</span><span class="T32">.</span></p><p class="P12"> </p><p class="P13">SELECT <span> d.pays, </span></p><p class="P13"><span> </span><span> <span class="T36">sum</span>(d.dispo_prot*365/<span class="T33">1000</span>) AS dispo_prot_kg_habitant</span></p><p class="P13">FROM<span>  </span><span> <span class="T35">fao.</span>dispo_alim d</span></p><p class="P13">GROUP BY<span> d.pays</span></p><p class="P28"><span class="T11">ORDER BY         dispo_prot_kg_habitant </span><span class="T13">ASC</span></p><p class="P13">LIMIT 10 ;</p><p class="P13"> </p><p class="P17">La quantité totale (en kg) de produits perdus par pays en 2013.</p><p class="P13"> </p><p class="P29"><span class="T11">SELECT         </span><span class="T14">e</span><span class="T11">.pays, </span></p><p class="P29"><span class="T11">                </span><span class="T22">sum</span><span class="T11">(</span><span class="T14">e</span><span class="T11">.</span><span class="T14">pertes</span><span class="T11">*</span><span class="T14">1000000</span><span class="T11">) AS </span><span class="T14">pertes_kg</span></p><p class="P29"><span class="T11">FROM                 </span><span class="T23">fao.</span><span class="T14">equilibre_prod</span><span class="T11"> </span><span class="T14">e</span></p><p class="P29"><span class="T11">GROUP BY        </span><span class="T14">e</span><span class="T11">.pays</span><span class="T13"> ;</span></p><p class="P14"> </p><p class="P18">Les 10 pays pour lesquels la proportion de personnes sous-alimentées est la plus forte<span class="T32">.</span></p><p class="P14"> </p><p class="P44">SELECT </p><p class="P44">    <span> </span><span> p.pays, (s.nb_personnes * 100 / p.population) AS pourcentage</span></p><p class="P44">FROM</p><p class="P44">    <span> </span><span> fao.population p,</span></p><p class="P44">    <span> </span><span> fao.sous_nutrition s</span></p><p class="P44">WHERE</p><p class="P44">   <span> </span><span> p.code_pays = s.code_pays</span></p><p class="P44">ORDER BY <span> pourcentage_ss_nutrition DESC</span></p><p class="P44">LIMIT 10;</p><p class="P15"> </p><p class="P15"> </p><p class="P32"><span class="T27">Les 10 produits pour lesquels le ratio </span><span class="Strong_20_Emphasis"><span class="T26">Autres utilisations/Disponibilité intérieure</span></span><span class="T27"> est le plus élevé.</span></p><p class="P19"> </p><p class="P42">SELECT </p><p class="P42">    <span> </span><span> e.produit,</span></p><p class="P42">    <span> </span><span> AVG(e.autres_utilisations * 100 / e.dispo_int) AS pourcentage_au_di</span></p><p class="P42">FROM</p><p class="P42">   <span> </span><span> fao.equilibre_prod e</span></p><p class="P42">GROUP BY <span> e.produit</span></p><p class="P42">ORDER BY <span> pourcentage_au_di DESC</span></p><p class="P42">LIMIT 10;</p><p class="P19"> </p><p class="P19"> </p><p class="P24">Question 20 : Identifier les « Autres utilisations »</p><p class="P20"> </p><p class="P41">Les autres utilisation des matière grasses sont :</p><p class="P41">- fabrication de savons</p><p class="P41">- fabrication de parfums et produits cosmétiques</p><p class="P41">- fabrication d’ agro-carburant</p><p class="P41">- utilisation comme lubrifiant</p></body></html>